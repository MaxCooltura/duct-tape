var e={};function s(e){return!("object"!=typeof e||null===e||Array.isArray(e)||e instanceof RegExp||e instanceof Date)}function t(e){return e instanceof Function}function i(e){return void 0!==e}function r(e,s){return"object"==typeof e&&Object.hasOwn(e,s)}function n(e,i){return s(e)&&t(e[i])}function o(e){return void 0===e||""===e||null===e||0===e}function l(e){return!0===e||"true"===e||"yes"===e||"on"===e||"t"===e||1===e||"1"===e}function h(e){return!1===e||"false"===e||"no"===e||"off"===e||"f"===e||0===e||"0"===e}function a(e,...t){if(!t.length)return e;const i=t.shift();if(s(e)&&s(i))for(const t in i)s(i[t])?(e[t]||Object.assign(e,{[t]:{}}),a(e[t],i[t])):Object.assign(e,{[t]:i[t]});return a(e,...t)}e.d=(s,t)=>{for(var i in t)e.o(t,i)&&!e.o(s,i)&&Object.defineProperty(s,i,{enumerable:!0,get:t[i]})},e.o=(e,s)=>Object.prototype.hasOwnProperty.call(e,s);class c{_disposed;_disposables=new Map;constructor(){this._disposed=!1}dispose(){if(!this._disposed)try{const e=Array.from(this._disposables.entries()).reverse();for(const[,s]of e)try{s()}catch(e){console.error(e)}this._disposables.clear()}finally{this._disposed=!0}}get disposed(){return this._disposed}register(e){return this._disposables.has(e)?(console.warn(`Cannot register ${e?.constructor?.name??e}. This object is already registered.`),e):(s(e)?n(e,"dispose")?this._disposables.set(e,()=>e.dispose()):n(e,"destroy")?this._disposables.set(e,()=>e.destroy()):n(e,"remove")?this._disposables.set(e,()=>e.remove()):console.warn(`The object ${e?.constructor?.name??e} has an unknown release function!`):t(e)?this._disposables.set(e,e):console.warn(`Cannot register ${e}. This object does not have a release function!`),e)}unregister(e){this._disposables.has(e)?this._disposables.delete(e):console.warn("Object ${o} doesn't exist in register.")}}class u extends c{_emitterHandles;constructor(){super(),this._emitterHandles={}}dispose(){this.disposed||(this._emitterHandles={},super.dispose())}on(e,s,t=this){return this._addCallback(e,s,t,!1),()=>this.off(e,s,t)}once(e,s,t=this){return this._addCallback(e,s,t,!0),()=>this.off(e,s,t)}off(e,s,t=this){const i=this._emitterHandles[e];if(i){let e=i.length;for(;--e>=0;)i[e].callback===s&&i[e].scope===t&&i.splice(e,1)}}emit(e,s){const t=this._emitterHandles[e];if(t)for(const i of t)i.callback.call(i.scope,s),i.once&&this.off(e,i.callback,i.scope)}_addCallback(e,s,t,i){let r=this._emitterHandles[e];r||(r=this._emitterHandles[e]=[]),r.push({callback:s,scope:t,once:i})}}const d=u;class b extends d{equal(e){let s;s=e instanceof Function?e:s=>s===e;const t=new v(this,s);return t.on("afterUnsubscribe",()=>{0===t.subscribersLength&&t.dispose()}),t}notEqual(e){let s;s="string"==typeof e?s=>s!==e:s=>!e(s);const t=new v(this,s);return t.on("afterUnsubscribe",()=>{0===t.subscribersLength&&t.dispose()}),t}format(e){const s=new v(this,e);return s.on("afterUnsubscribe",()=>{0===s.subscribersLength&&s.dispose()}),s}mapBoolean(e,s){const t=new v(this,t=>!0===t?e:!1===t?s:void 0);return t.on("afterUnsubscribe",()=>{0===t.subscribersLength&&t.dispose()}),t}not(){const e=new v(this,e=>!e);return e.on("afterUnsubscribe",()=>{0===e.subscribersLength&&e.dispose()}),e}and(e){const s=new m(this,e,(e,s)=>!!e&&!!s);return s.on("afterUnsubscribe",()=>{0===s.subscribersLength&&s.dispose()}),s}or(e){const s=new m(this,e,(e,s)=>!!e||!!s);return s.on("afterUnsubscribe",()=>{0===s.subscribersLength&&s.dispose()}),s}}function p(e){return e instanceof b}class f extends b{listeners=[];value;initValue;prev;constructor(e){super(),this.value=e,this.initValue=e,this.prev=void 0}dispose(){this.disposed||(this.listeners.splice(0,this.listeners.length),super.dispose())}subscribe(e,s=this){const t={callback:e,scope:s};return this.listeners.push(t),this.deliveryValueToSubscriber(t,this.value,this.prev),()=>{this.listeners.splice(this.listeners.indexOf(t),1),this.emit("afterUnsubscribe",this)}}set(e){const s="function"==typeof e?e(this.get(),this.initValue):e;this.prev=this.get(),this.value!==s&&(Array.isArray(this.value)?this.value=[...s]:"object"==typeof this.value?this.value=a(this.value,s):this.value=s,this.deliveryValue(this.value,this.prev))}reinitAndSet(e){"object"==typeof e?this.set({...this.initValue,...e}):this.set(e)}get(){return Array.isArray(this.value)?[...this.value]:"object"==typeof this.value?a({},this.value):this.value}toString(){return void 0===this.value||null===this.value?"undefined":this.value.toString()}deliveryValue(e,s){for(const t of this.listeners)this.deliveryValueToSubscriber(t,e,s)}deliveryValueToSubscriber(e,s,t){e.callback.call(e.scope,s,t)}}class v extends b{listeners=[];watch;prev;value;transform;constructor(e,s){super(),this.watch=e,this.transform=s,this.value=this.transform(this.watch.get()),this.register(this.watch.subscribe(e=>{const s=this.transform(e);this.value!==s&&(this.prev=this.value,this.value=s,this.deliverValue(this.value,this.prev))}))}subscribe(e,s=this){const t={callback:e,scope:s};return this.listeners.push(t),this.deliverValueToSubscriber(t,this.value,this.prev),()=>{this.listeners.splice(this.listeners.indexOf(t),1),this.emit("afterUnsubscribe",void 0)}}get(){return this.value}toString(){return this.watch.toString()}get subscribersLength(){return this.listeners.length}deliverValue(e,s){for(const t of this.listeners)this.deliverValueToSubscriber(t,e,s)}deliverValueToSubscriber(e,s,t){e.callback.call(e.scope,s,t)}}class m extends b{listeners=[];watch1;watch2;prev;value;transform;constructor(e,s,t){super(),this.watch1=e,this.watch2=s,this.transform=t,this.value=this.transform(this.watch1.get(),this.watch2.get()),this.register(this.watch1.subscribe(e=>{const s=this.transform(e,this.watch2.get());this.value!==s&&(this.prev=this.value,this.value=s,this.deliverValue(this.value,this.prev))})),this.register(this.watch2.subscribe(e=>{const s=this.transform(this.watch1.get(),e);this.value!==s&&(this.prev=this.value,this.value=s,this.deliverValue(this.value,this.prev))}))}subscribe(e,s=this){const t={callback:e,scope:s};return this.listeners.push(t),this.deliverValueToSubscriber(t,this.value,this.prev),()=>{this.listeners.splice(this.listeners.indexOf(t),1),this.emit("afterUnsubscribe",void 0)}}get(){return this.value}toString(){return this.watch1.toString()+this.watch2.toString()}get subscribersLength(){return this.listeners.length}deliverValue(e,s){for(const t of this.listeners)this.deliverValueToSubscriber(t,e,s)}deliverValueToSubscriber(e,s,t){e.callback.call(e.scope,s,t)}dispose(){this.disposed||(this.listeners.splice(0,this.listeners.length),super.dispose())}}function g(e,s){const t=new _(e);return s instanceof c&&s.register(t),t}class _ extends c{_element;constructor(e){super();const s=e.split(":");if(1===s.length)this._element=document.createElement(e);else{if(2!==s.length)throw new Error("Invalid selector");{const e=s[0],t=s[1];this._element=document.createElementNS(e,t)}}}attr(e,s){return s instanceof b?this.register(s.subscribe(s=>{this._element.setAttribute(e,String(s))})):this._element.setAttribute(e,String(s)),this}property(e,s){return void 0===s?this._element[e]:(s instanceof b?this.register(s.subscribe(s=>{this._element[e]=s})):this._element[e]=s,this)}style(e,s){return s instanceof b?this.register(s.subscribe(s=>{this._element.style[e]=s})):this._element.style[e]=s,this}class(e,s=!0){return s instanceof b?this.register(s.subscribe(s=>{s?Array.isArray(e)?this._element.classList.add(...e):this._element.classList.add(e):Array.isArray(e)?this._element.classList.remove(...e):this._element.classList.remove(e)})):s?Array.isArray(e)?this._element.classList.add(...e):this._element.classList.add(e):Array.isArray(e)?this._element.classList.remove(...e):this._element.classList.remove(e),this}on(e,s,t){return this._element.addEventListener(e,s,t),this.register(()=>{this._element.removeEventListener(e,s,t)}),this}off(e,s,t){return this._element.removeEventListener(e,s,t),this}text(e){if(e instanceof b){const s=document.createTextNode("");this._element.appendChild(s),this.register(e.subscribe(e=>{s.textContent=String(e)}))}else this._element.innerText=String(e);return this}html(e){return this._element.innerHTML=e,this}append(...e){for(const s of e)this._element.appendChild(s.element);return this}mount(e){return e instanceof _?e._element.appendChild(this._element):e.appendChild(this._element),this}get element(){return this._element}}export{_ as DOMNode,c as Disposable,u as Emitter,b as Value,m as ValueLogicObserver,v as ValueObserver,f as ValueStore,g as create,n as hasOwnFunction,r as hasOwnProperty,i as isDefined,o as isEmpty,h as isFalse,t as isFunction,s as isObject,l as isTrue,p as isValue,a as mergeDeep};