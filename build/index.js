var e={};function t(e){return!("object"!=typeof e||null===e||Array.isArray(e)||e instanceof RegExp||e instanceof Date)}function s(e){return e instanceof Function}function i(e){return void 0!==e}function r(e,t){return"object"==typeof e&&Object.hasOwn(e,t)}function n(e,i){return t(e)&&s(e[i])}function o(e){return void 0===e||""===e||null===e||0===e}function l(e){return!0===e||"true"===e||"yes"===e||"on"===e||"t"===e||1===e||"1"===e}function h(e){return!1===e||"false"===e||"no"===e||"off"===e||"f"===e||0===e||"0"===e}function a(e,...s){if(!s.length)return e;const i=s.shift();if(t(e)&&t(i))for(const s in i)t(i[s])?(e[s]||Object.assign(e,{[s]:{}}),a(e[s],i[s])):Object.assign(e,{[s]:i[s]});return a(e,...s)}function c(e){return e}e.d=(t,s)=>{for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})},e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);class u{_disposed;_disposables=new Map;constructor(){this._disposed=!1}dispose(){if(!this._disposed)try{const e=Array.from(this._disposables.entries()).reverse();for(const[,t]of e)try{t()}catch(e){console.error(e)}this._disposables.clear()}finally{this._disposed=!0}}get disposed(){return this._disposed}register(e){return this._disposables.has(e)?(console.warn(`Cannot register ${e?.constructor?.name??e}. This object is already registered.`),e):(t(e)?n(e,"dispose")?this._disposables.set(e,()=>e.dispose()):n(e,"destroy")?this._disposables.set(e,()=>e.destroy()):n(e,"remove")?this._disposables.set(e,()=>e.remove()):console.warn(`The object ${e?.constructor?.name??e} has an unknown release function!`):s(e)?this._disposables.set(e,e):console.warn(`Cannot register ${e}. This object does not have a release function!`),e)}unregister(e){this._disposables.has(e)?this._disposables.delete(e):console.warn("Object ${o} doesn't exist in register.")}}class d extends u{_emitterHandles;constructor(){super(),this._emitterHandles={}}dispose(){this.disposed||(this._emitterHandles={},super.dispose())}on(e,t,s=this){return this._addCallback(e,t,s,!1),()=>this.off(e,t,s)}once(e,t,s=this){return this._addCallback(e,t,s,!0),()=>this.off(e,t,s)}off(e,t,s=this){const i=this._emitterHandles[e];if(i){let e=i.length;for(;--e>=0;)i[e].callback===t&&i[e].scope===s&&i.splice(e,1)}}emit(e,t){const s=this._emitterHandles[e];if(s)for(const i of s)i.callback.call(i.scope,t),i.once&&this.off(e,i.callback,i.scope)}_addCallback(e,t,s,i){let r=this._emitterHandles[e];r||(r=this._emitterHandles[e]=[]),r.push({callback:t,scope:s,once:i})}}const b=d;function p(e,t=!1){if(e instanceof f&&(e=e.get()),"boolean"==typeof e)return e;if("string"==typeof e){const t=e.toLowerCase();if("true"===t||"1"===t||"yes"===t||"on"===t)return!0;if("false"===t||"0"===t||"no"===t||"off"===t)return!1}else if("number"==typeof e)return 0!==e;return t}class f extends b{equal(e){let t;t=e instanceof Function?e:t=>t===e;const s=new _(this,t);return s.on("afterUnsubscribe",()=>{0===s.subscribersLength&&s.dispose()}),s}notEqual(e){let t;t="string"==typeof e?t=>t!==e:t=>!e(t);const s=new _(this,t);return s.on("afterUnsubscribe",()=>{0===s.subscribersLength&&s.dispose()}),s}format(e){const t=new _(this,e);return t.on("afterUnsubscribe",()=>{0===t.subscribersLength&&t.dispose()}),t}map(e){const t=new _(this,e);return t.on("afterUnsubscribe",()=>{0===t.subscribersLength&&t.dispose()}),t}mapBoolean(e,t){const s=new _(this,s=>!0===p(s)?e:t);return s.on("afterUnsubscribe",()=>{0===s.subscribersLength&&s.dispose()}),s}not(){const e=new _(this,e=>!p(e));return e.on("afterUnsubscribe",()=>{0===e.subscribersLength&&e.dispose()}),e}and(e){const t=new g(this,e,(e,t)=>p(e)&&p(t));return t.on("afterUnsubscribe",()=>{0===t.subscribersLength&&t.dispose()}),t}or(e){const t=new g(this,e,(e,t)=>p(e)||p(t));return t.on("afterUnsubscribe",()=>{0===t.subscribersLength&&t.dispose()}),t}}function v(e){return e instanceof f}class m extends f{listeners=[];value;initValue;prev;constructor(e){super(),this.value=e,this.initValue=e,this.prev=void 0}dispose(){this.disposed||(this.listeners.splice(0,this.listeners.length),super.dispose())}subscribe(e,t=this){const s={callback:e,scope:t};return this.listeners.push(s),this.deliveryValueToSubscriber(s,this.value,this.prev),()=>{this.listeners.splice(this.listeners.indexOf(s),1),this.emit("afterUnsubscribe",this)}}set(e){this.prev=this.get(),this.value!==e&&null!=e&&typeof e==typeof this.value&&(Array.isArray(this.value)?this.value=[...e]:"object"==typeof this.value?this.value=a(this.value,e):this.value=e,this.deliveryValue(this.value,this.prev))}get(){return Array.isArray(this.value)?[...this.value]:"object"==typeof this.value?a({},this.value):this.value}toString(){return void 0===this.value||null===this.value?"undefined":this.value.toString()}deliveryValue(e,t){for(const s of this.listeners)this.deliveryValueToSubscriber(s,e,t)}deliveryValueToSubscriber(e,t,s){e.callback.call(e.scope,t,s)}}class _ extends f{listeners=[];watch;prev;value;_transform;constructor(e,t){super(),this.watch=e,this._transform=t,this.value=this._transform(this.watch.get()),this.register(this.watch.subscribe(e=>{const t=this._transform(e);this.value!==t&&(this.prev=this.value,this.value=t,this.deliverValue(this.value,this.prev))}))}subscribe(e,t=this){const s={callback:e,scope:t};return this.listeners.push(s),this.deliverValueToSubscriber(s,this.value,this.prev),()=>{this.listeners.splice(this.listeners.indexOf(s),1),this.emit("afterUnsubscribe",void 0)}}get(){return this.value}toString(){return this.watch.toString()}get subscribersLength(){return this.listeners.length}deliverValue(e,t){for(const s of this.listeners)this.deliverValueToSubscriber(s,e,t)}deliverValueToSubscriber(e,t,s){e.callback.call(e.scope,t,s)}}class g extends f{listeners=[];watch1;watch2;prev;value;transform;constructor(e,t,s){super(),this.watch1=e,this.watch2=t,this.transform=s,this.value=this.transform(this.watch1.get(),this.watch2.get()),this.register(this.watch1.subscribe(e=>{const t=this.transform(e,this.watch2.get());this.value!==t&&(this.prev=this.value,this.value=t,this.deliverValue(this.value,this.prev))})),this.register(this.watch2.subscribe(e=>{const t=this.transform(this.watch1.get(),e);this.value!==t&&(this.prev=this.value,this.value=t,this.deliverValue(this.value,this.prev))}))}subscribe(e,t=this){const s={callback:e,scope:t};return this.listeners.push(s),this.deliverValueToSubscriber(s,this.value,this.prev),()=>{this.listeners.splice(this.listeners.indexOf(s),1),this.emit("afterUnsubscribe",void 0)}}get(){return this.value}toString(){return this.watch1.toString()+this.watch2.toString()}get subscribersLength(){return this.listeners.length}deliverValue(e,t){for(const s of this.listeners)this.deliverValueToSubscriber(s,e,t)}deliverValueToSubscriber(e,t,s){e.callback.call(e.scope,t,s)}dispose(){this.disposed||(this.listeners.splice(0,this.listeners.length),super.dispose())}}function y(e,t){return w.create(e)}class w extends u{_element;_events=new Map;static create(e,t){const s=new w(e);return t instanceof u&&t.register(s),s}constructor(e){super();const t=e.split(":");if(1===t.length)this._element=document.createElement(e);else{if(2!==t.length)throw new Error("Invalid selector");{const e=t[0],s=t[1];this._element=document.createElementNS(e,s)}}}dispose(){this._disposed||(this._element.remove(),super.dispose())}attr(e,t){return t instanceof f?this.register(t.subscribe(t=>{this._element.setAttribute(e,String(t))})):this._element.setAttribute(e,String(t)),this}property(e,t){return void 0===t?this._element[e]:(t instanceof f?this.register(t.subscribe(t=>{this._element[e]=t})):this._element[e]=t,this)}style(e,t){return t instanceof f?this.register(t.subscribe(t=>{this._element.style[e]=t})):this._element.style[e]=t,this}class(e,t=!0){return t instanceof f?this.register(t.subscribe(t=>{t?Array.isArray(e)?this._element.classList.add(...e):this._element.classList.add(e):Array.isArray(e)?this._element.classList.remove(...e):this._element.classList.remove(e)})):t?Array.isArray(e)?this._element.classList.add(...e):this._element.classList.add(e):Array.isArray(e)?this._element.classList.remove(...e):this._element.classList.remove(e),this}on(e,t,s){for(const[,s]of this._events.entries())if(s.eventType===e&&s.listener===t)return console.warn(`The event listener for ${e} is already registered on this element.`),this;this._element.addEventListener(e,t,s);const i=()=>{this._element.removeEventListener(e,t,s)};return this.register(i),this._events.set(i,{eventType:e,listener:t}),this}off(e,t,s){this._element.removeEventListener(e,t,s);for(const[s,i]of this._events.entries())if(i.eventType===e&&i.listener===t){this._events.delete(s),this.unregister(s);break}return this}datum(e){return 0===arguments.length?this._element.__datum__:(this._element.__datum__=e,this)}text(e){if(e instanceof f){const t=document.createTextNode("");this._element.appendChild(t),this.register(e.subscribe(e=>{t.textContent=String(e)}))}else this._element.innerText=String(e);return this}html(e){return this._element.innerHTML=e,this}append(...e){for(const t of e)this._element.appendChild(t.element);return this}mount(e){return e instanceof w?e._element.appendChild(this._element):e.appendChild(this._element),this}get element(){return this._element}}export{w as DOMNode,u as Disposable,d as Emitter,f as Value,g as ValueLogicObserver,_ as ValueObserver,m as ValueStore,y as create,c as createDisposeFn,n as hasOwnFunction,r as hasOwnProperty,i as isDefined,o as isEmpty,h as isFalse,s as isFunction,t as isObject,l as isTrue,v as isValue,a as mergeDeep};